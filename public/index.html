<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SecureVault - Life Manager</title>

    <link rel="icon" type="image/svg+xml" href="icon.svg" />
    <link rel="apple-touch-icon" href="icon-192.png" />
    <!-- iOS အတွက် -->
    <link rel="manifest" href="manifest.json" />
    <!-- Libraries -->
    <!-- Icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />

    <!-- Crypto JS (Encryption အတွက်) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <!-- 1. GOOGLE LOGIN SCREEN -->
    <div id="auth-screen" class="screen active">
      <div class="center-card">
        <div class="logo"><i class="fas fa-shield-alt"></i> SecureVault</div>
        <p>Your Digital Life, Secured on Your Drive.</p>
        <button onclick="googleLogin()" class="btn-google">
          <i class="fab fa-google"></i> Sign in with Google
        </button>
        <p class="small-note">
          We store encrypted data only on your personal Google Drive.
        </p>
      </div>
    </div>

    <!-- 2. MASTER PASSWORD SETUP / LOGIN (Encryption Key) -->
    <div id="master-screen" class="screen" style="display: none">
      <div class="center-card">
        <div class="icon-lock"><i class="fas fa-lock"></i></div>
        <h2 id="master-title">Unlock Vault</h2>
        <p id="master-desc">Enter your Master Password to decrypt your data.</p>

        <div class="input-group">
          <input
            type="password"
            id="master-pass"
            placeholder="Master Password"
          />
          <i
            class="fas fa-eye toggle-pass"
            onclick="togglePass('master-pass')"
          ></i>
        </div>

        <button onclick="unlockVault()" class="btn-primary">Unlock</button>
        <p class="warning-text">
          <i class="fas fa-exclamation-triangle"></i> If you forget this
          password, your data cannot be recovered.
        </p>
      </div>
    </div>

    <!-- 3. MAIN DASHBOARD -->
    <div id="app-screen" class="app-layout" style="display: none">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="brand"><i class="fas fa-shield-alt"></i> Vault</div>

        <div class="menu">
          <button class="menu-item active" onclick="filterCategory('all')">
            <i class="fas fa-th-large"></i> All Items
          </button>
          <button class="menu-item" onclick="filterCategory('fav')">
            <i class="fas fa-star text-yellow"></i> Favorites
          </button>

          <div class="menu-label">Categories</div>
          <button class="menu-item" onclick="filterCategory('home')">
            <i class="fas fa-home"></i> Home & HOA
          </button>
          <button class="menu-item" onclick="filterCategory('bank')">
            <i class="fas fa-university"></i> Finance
          </button>
          <button class="menu-item" onclick="filterCategory('car')">
            <i class="fas fa-car"></i> Auto
          </button>
          <button class="menu-item" onclick="filterCategory('work')">
            <i class="fas fa-briefcase"></i> Work
          </button>
          <button class="menu-item" onclick="filterCategory('health')">
            <i class="fas fa-heartbeat"></i> Health
          </button>
          <button class="menu-item" onclick="filterCategory('social')">
            <i class="fas fa-globe"></i> Social/Email
          </button>
        </div>

        <div class="user-footer">
          <div id="user-display">User</div>
          <button onclick="logout()" class="btn-logout">
            <i class="fas fa-sign-out-alt"></i>
          </button>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="content">
        <header class="top-bar">
          <div class="search-box">
            <i class="fas fa-search"></i>
            <input
              type="text"
              id="search-input"
              placeholder="Search accounts, banks..."
              onkeyup="renderItems()"
            />
          </div>
          <button onclick="openModal()" class="btn-add">
            <i class="fas fa-plus"></i> Add New
          </button>
        </header>

        <div id="loader" style="display: none">
          <i class="fas fa-circle-notch fa-spin"></i> Syncing with Drive...
        </div>

        <div id="vault-grid" class="grid-container">
          <!-- Items will be injected here -->
        </div>
      </main>
    </div>

    <!-- ADD/EDIT MODAL -->
    <div id="item-modal" class="modal-overlay">
      <div class="modal-box">
        <div class="modal-header">
          <h3 id="modal-title">Add Account</h3>
          <button onclick="closeModal()" class="btn-close">&times;</button>
        </div>
        <div class="modal-body">
          <input type="hidden" id="edit-id" />

          <div class="form-row">
            <div class="field">
              <label>Category</label>
              <select id="inp-cat">
                <option value="home">Home (Insurance/HOA)</option>
                <option value="bank">Finance (Bank/Escrow)</option>
                <option value="car">Auto (Car/Insurance)</option>
                <option value="work">Work/Business</option>
                <option value="health">Health/Medical</option>
                <option value="social">Social/Email</option>
                <option value="other">Other</option>
              </select>
            </div>
            <div class="field">
              <label>Title (e.g. Flood Insurance)</label>
              <input type="text" id="inp-title" placeholder="Account Name" />
            </div>
          </div>

          <div class="field">
            <label>Username / Login ID</label>
            <input type="text" id="inp-user" />
          </div>

          <div class="field">
            <label>Password</label>
            <div class="input-group">
              <input type="text" id="inp-pass" placeholder="Secret Password" />
              <button class="btn-gen" onclick="generateStrongPass()">
                Generate
              </button>
            </div>
          </div>

          <div class="field">
            <label>Security Questions / PIN</label>
            <textarea
              id="inp-sec"
              rows="2"
              placeholder="Q: Pet name? A: Lucky"
            ></textarea>
          </div>

          <div class="field">
            <label>Website / Note</label>
            <input type="text" id="inp-url" placeholder="https://..." />
          </div>

          <div class="modal-footer">
            <button onclick="saveItem()" class="btn-primary full">
              Save Securely
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- PWA Installer Script -->
    <script>
      if ("serviceWorker" in navigator) {
        navigator.serviceWorker
          .register("./sw.js")
          .then((reg) => console.log("Service Worker Registered"))
          .catch((err) => console.log("Service Worker Error", err));
      }
    </script>

    <script src="script.js"></script>
  </body>
</html>
