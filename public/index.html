<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CloudKeeper</title>
    
    <!-- PWA Settings -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="icon.svg">
    <meta name="theme-color" content="#2563EB">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- 1. LOGIN SCREEN -->
    <div id="login-view" class="view active">
        <div class="login-card">
            <div class="logo-circle"><i class="fas fa-cloud-lock"></i></div>
            <h1>CloudKeeper</h1>
            <p>Your Secure Vault on Google Drive</p>
            <button onclick="handleAuthClick()" class="btn-google">
                <img src="https://www.svgrepo.com/show/475656/google-color.svg" alt="G">
                Sign in with Google
            </button>
            <p class="note">Encrypted & Stored on your Drive.</p>
        </div>
    </div>

    <!-- 2. DASHBOARD -->
    <div id="app-view" class="view" style="display: none;">
        
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="brand">
                <i class="fas fa-shield-alt"></i> <span>Keeper</span>
            </div>
            
            <!-- Menu Container (User Panel is now INSIDE for mobile scroll) -->
            <div class="menu-container">
                <button class="menu-item active" onclick="filterData('all')"><i class="fas fa-border-all"></i> <span>All Items</span></button>
                <button class="menu-item" onclick="filterData('fav')"><i class="fas fa-star text-yellow"></i> <span>Favorites</span></button>
                
                <div class="menu-label">Categories</div>
                <button class="menu-item" onclick="filterData('social')"><i class="fas fa-globe"></i> <span>Social</span></button>
                <button class="menu-item" onclick="filterData('bank')"><i class="fas fa-wallet"></i> <span>Finance</span></button>
                <button class="menu-item" onclick="filterData('wireless')"><i class="fas fa-wifi"></i> <span>Wireless</span></button>
                <button class="menu-item" onclick="filterData('tv')"><i class="fas fa-tv"></i> <span>TV & Ent.</span></button>
                <button class="menu-item" onclick="filterData('auto')"><i class="fas fa-car"></i> <span>Auto</span></button>
                <button class="menu-item" onclick="filterData('insurance')"><i class="fas fa-file-contract"></i> <span>Insurance</span></button>
                <button class="menu-item" onclick="filterData('home')"><i class="fas fa-home"></i> <span>Home</span></button>
                <button class="menu-item" onclick="filterData('work')"><i class="fas fa-briefcase"></i> <span>Work</span></button>

                <!-- Help Button -->
                <button class="menu-item" onclick="openGuide()"><i class="fas fa-question-circle"></i> <span>Guide & Privacy</span></button>

                <!-- User Panel (Moved Inside) -->
                <div class="user-panel">
                    <img id="user-avatar" src="" alt="User" onerror="this.src='https://cdn-icons-png.flaticon.com/512/149/149071.png'">
                    <div class="user-details">
                        <span id="user-name">User</span>
                        <button onclick="handleSignoutClick()" class="btn-sm">Logout</button>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-area">
            <header>
                <div class="search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" id="search-input" placeholder="Search vault..." onkeyup="renderList()">
                </div>
                
                <div class="header-actions">
                    <div class="view-toggles">
                        <button class="btn-toggle active" id="btn-grid" onclick="toggleView('grid')"><i class="fas fa-th-large"></i></button>
                        <button class="btn-toggle" id="btn-list" onclick="toggleView('list')"><i class="fas fa-list"></i></button>
                    </div>
                    <button onclick="openModal('add')" class="btn-primary"><i class="fas fa-plus"></i> <span class="desk-only">Add New</span></button>
                </div>
            </header>

            <div id="sync-status" class="status-bar hidden">
                <i class="fas fa-sync fa-spin"></i> Syncing with Google Drive...
            </div>

            <div id="data-list" class="grid-layout"></div>
        </main>
    </div>

    <!-- ADD/EDIT MODAL -->
    <div id="entry-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <!-- Modal Title ID added -->
                <h3 id="modal-title"><i class="fas fa-pen-to-square"></i> New Account</h3>
                <span onclick="closeModal()" class="close">&times;</span>
            </div>
            <div class="modal-body">
                <input type="hidden" id="entry-id">
                
                <div class="form-grid">
                    <div class="input-group">
                        <label>Category</label>
                        <select id="inp-cat">
                            <option value="social">Social Media</option>
                            <option value="bank">Finance / Bank</option>
                            <option value="wireless">Wireless / Mobile</option>
                            <option value="tv">TV / Entertainment</option>
                            <option value="auto">Auto / Car</option>
                            <option value="insurance">Insurance</option>
                            <option value="home">Home / Utilities</option>
                            <option value="work">Work / Business</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>Title</label>
                        <input type="text" id="inp-title" placeholder="e.g. Netflix">
                    </div>
                </div>

                <div class="input-group">
                    <label>Username / ID</label>
                    <div class="icon-input">
                        <i class="fas fa-user"></i>
                        <input type="text" id="inp-user">
                    </div>
                </div>

                <div class="input-group">
                    <label>Password</label>
                    <div class="pass-box">
                        <div class="icon-input">
                            <i class="fas fa-key"></i>
                            <input type="text" id="inp-pass">
                        </div>
                        <button onclick="genPass()" class="btn-gen"><i class="fas fa-magic"></i></button>
                    </div>
                </div>

                <div class="input-group">
                    <label>Notes / Security Q</label>
                    <textarea id="inp-note" rows="3"></textarea>
                </div>

                <div class="modal-footer">
                    <button onclick="saveEntry()" class="btn-save">Save Securely</button>
                </div>
            </div>
        </div>
    </div>

    <!-- GUIDE MODAL (New) -->
    <div id="guide-modal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Guide & Privacy</h3>
                <span onclick="closeGuide()" class="close">&times;</span>
            </div>
            <div class="modal-body scroll-body">
                <h4>ðŸš€ How to use (á€¡á€žá€¯á€¶á€¸á€•á€¼á€¯á€”á€Šá€ºá€¸)</h4>
                <ul class="guide-list">
                    <li><b>Login:</b> Sign in with your Google Account to access your secure drive space.</li>
                    <li><b>Add Item:</b> Click "+ Add New" to store accounts (Bank, Wifi, Social, etc.).</li>
                    <li><b>Encryption:</b> All data is encrypted on your device *before* sending to Google Drive. Only you can read it.</li>
                    <li><b>Sync:</b> Data is saved to `cloud_keeper_data_v2.json` in your Drive. It syncs across devices.</li>
                </ul>
                
                <hr>
                
                <h4>ðŸ”’ Privacy Policy</h4>
                <p class="privacy-text">
                    This app is a standalone tool developed by an independent developer. <br>
                    1. <b>No Tracking:</b> We do not track you or store your data on our servers. <br>
                    2. <b>Ownership:</b> Your data lives in YOUR Google Drive. You have full control. <br>
                    3. <b>Security:</b> We use AES Encryption. Even Google cannot read your passwords.
                </p>
            </div>
        </div>
    </div>

    <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
    <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
    <script src="script.js"></script>
</body>
</html>